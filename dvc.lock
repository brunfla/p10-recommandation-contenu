schema: '2.0'
stages:
  üß†_train_model:
    cmd: "papermill notebooks/training.ipynb _ -p metadata_path data/deps/articles_metadata.csv\
      \  -p clicks_path data/deps/clicks_sample.csv -p embeddings_path data/deps/articles_embeddings.pickle
      -p content_based_model_path data/outs/model/content_based_model.pkl -p collaborative_model_path
      data/outs/model/collaborative_filtering_svd.pkl\n"
    deps:
    - path: data/deps/articles_embeddings.pickle
      hash: md5
      md5: cf45825fa33b7700e29e81c492a610ec
      size: 364047163
    - path: data/deps/articles_metadata.csv
      hash: md5
      md5: 0a0fba504a6133ee5e9c391dff7e5217
      size: 11093922
    - path: data/deps/clicks_sample.csv
      hash: md5
      md5: b67fcaa316566ccee1d24570f6e9d11d
      size: 134214
    outs:
    - path: data/outs/model/collaborative_filtering_svd.pkl
      hash: md5
      md5: 8670fb35fc6f28c7a9f9c57eb38e9a71
      size: 895982
    - path: data/outs/model/content_based_model.pkl
      hash: md5
      md5: 1a5fca98a68419d346e96750374a9a8f
      size: 366964067
  ‚òÅÔ∏è_upload_model:
    cmd: ./scripts/upload_model.sh
    deps:
    - path: data/outs/model/model_svd.pkl
      hash: md5
      md5: 02fd6321992447801deae7dad89ac311
      size: 895982
    - path: scripts/upload_model.sh
      hash: md5
      md5: 6e053f06e9490e0232f9d9627b93cefa
      size: 162
      isexec: true
  üöÄ_deploy_function:
    cmd: ./scripts/deploy_function.sh
    deps:
    - path: scripts/deploy_function.sh
      hash: md5
      md5: de09ad61e0c05eb7f9411d85fe78d6a6
      size: 316
      isexec: true
  üé®_Deploy_Streamlit_App:
    cmd: ./scripts/deploy_streamlit.sh
    deps:
    - path: scripts/deploy_streamlit.sh
      hash: md5
      md5: 4234148393ff7d9c1c746a994a391e11
      size: 149
      isexec: true
  ‚òÅÔ∏è_upload_content_based_model:
    cmd: ./scripts/upload_model.sh content_based_model.pkl
    deps:
    - path: data/outs/model/content_based_model.pkl
      hash: md5
      md5: 1a5fca98a68419d346e96750374a9a8f
      size: 366964067
    - path: scripts/upload_model.sh
      hash: md5
      md5: e485434ba6f1bb0f16e3707d9f598db3
      size: 655
      isexec: true
  ‚òÅÔ∏è_upload_collaborative_filtering_model:
    cmd: ./scripts/upload_model.sh collaborative_filtering_svd.pkl
    deps:
    - path: data/outs/model/collaborative_filtering_svd.pkl
      hash: md5
      md5: 8670fb35fc6f28c7a9f9c57eb38e9a71
      size: 895982
    - path: scripts/upload_model.sh
      hash: md5
      md5: e485434ba6f1bb0f16e3707d9f598db3
      size: 655
      isexec: true
  üîç_test_streamlit_app:
    cmd: ./scripts/test_streamlit.sh
    deps:
    - path: scripts/test_streamlit.sh
      hash: md5
      md5: 87dd8258b489ffd953d0a3932a338391
      size: 2127
      isexec: true
  train_model:
    cmd: "papermill notebooks/training.ipynb _ -p metadata_path data/deps/articles_metadata.csv\
      \  -p clicks_path data/deps/clicks_sample.csv -p embeddings_path data/deps/articles_embeddings.pickle
      -p content_based_model_path data/outs/model/content_based_model.pkl -p collaborative_model_path
      data/outs/model/collaborative_filtering_svd.pkl\n"
    deps:
    - path: data/deps/articles_embeddings.pickle
      hash: md5
      md5: cf45825fa33b7700e29e81c492a610ec
      size: 364047163
    - path: data/deps/articles_metadata.csv
      hash: md5
      md5: 0a0fba504a6133ee5e9c391dff7e5217
      size: 11093922
    - path: data/deps/clicks_sample.csv
      hash: md5
      md5: b67fcaa316566ccee1d24570f6e9d11d
      size: 134214
    - path: notebooks/training.ipynb
      hash: md5
      md5: cc3032a64be5c75464a36d4aa75688c8
      size: 1441570
    outs:
    - path: data/outs/model/collaborative_filtering_svd.pkl
      hash: md5
      md5: 0f2d60aaa5f124e682bf2d1e4cccfd13
      size: 113164
    - path: data/outs/model/content_based_model.pkl
      hash: md5
      md5: 1a5fca98a68419d346e96750374a9a8f
      size: 366964067
  upload_content_based_model:
    cmd: ./scripts/upload_model.sh content_based_model.pkl
    deps:
    - path: data/outs/model/content_based_model.pkl
      hash: md5
      md5: 1a5fca98a68419d346e96750374a9a8f
      size: 366964067
    - path: scripts/upload_model.sh
      hash: md5
      md5: e485434ba6f1bb0f16e3707d9f598db3
      size: 655
      isexec: true
  upload_collaborative_filtering_model:
    cmd: ./scripts/upload_model.sh collaborative_filtering_svd.pkl
    deps:
    - path: data/outs/model/collaborative_filtering_svd.pkl
      hash: md5
      md5: 0f2d60aaa5f124e682bf2d1e4cccfd13
      size: 113164
    - path: scripts/upload_model.sh
      hash: md5
      md5: e485434ba6f1bb0f16e3707d9f598db3
      size: 655
      isexec: true
  deploy_function:
    cmd: ./scripts/deploy_function.sh
    deps:
    - path: scripts/deploy_function.sh
      hash: md5
      md5: bfcd2d40665f80c493e414cdab5a6897
      size: 1929
      isexec: true
  deploy_Streamlit_App:
    cmd: ./scripts/deploy_streamlit.sh
    deps:
    - path: scripts/deploy_streamlit.sh
      hash: md5
      md5: a13d3ea5c1faa51b47604eca34ecbff4
      size: 211
      isexec: true
  test_streamlit_app:
    cmd: ./scripts/test_streamlit.sh
    deps:
    - path: scripts/test_streamlit.sh
      hash: md5
      md5: 87dd8258b489ffd953d0a3932a338391
      size: 2127
      isexec: true
  deploy:
    cmd: LOCAL=true docker-compose up -d --force-recreate
  test:
    cmd: ./scripts/test.sh
    deps:
    - path: scripts/test.sh
      hash: md5
      md5: beb2ac34ecfa175ffb2975c20840c662
      size: 1914
      isexec: true
  build:
    cmd: LOCAL=true docker-compose build
    deps:
    - path: azure_function/Dockerfile
      hash: md5
      md5: b3efcce277bfc9c347df5d99afc6ee2c
      size: 1225
    - path: docker-compose.yml
      hash: md5
      md5: b811997c6350952146175f72d2ffdf57
      size: 340
    - path: streamlit_app/Dockerfile
      hash: md5
      md5: 56ad1cfdd931801b25885138a8b025df
      size: 223
